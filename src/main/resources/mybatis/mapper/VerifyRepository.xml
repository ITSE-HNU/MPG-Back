<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ghstudio.pairprogram.dao.repository.VerifyRepository">
    <resultMap id="VerifyMap" type="com.ghstudio.pairprogram.dao.entity.Verify">
        <id property="id" column="id"/>
        <result property="phone" column="phone"/>
        <result property="code" column="code"/>
        <result property="createdAt" column="create_at"/>
    </resultMap>
    <select id="getCodeByPhone" resultMap="com.ghstudio.pairprogram.dao.repository.VerifyRepository.VerifyMap">
        SELECT *
        FROM verify
        WHERE phone = #{phone}
        ORDER BY create_at desc
        LIMIT 1
    </select>

    <insert id="createVerify" parameterType="com.ghstudio.pairprogram.dao.entity.Verify" useGeneratedKeys="true"
            keyProperty="id" keyColumn="id">
        INSERT INTO verify(phone, code, create_at)
        VALUES (#{phone}, #{code}, now())
    </insert>
</mapper>
